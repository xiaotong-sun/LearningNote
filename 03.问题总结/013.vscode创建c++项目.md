# Vscode创建c++项目

## 正文

**目标：**创建C++文件，并自动生成tasks.json和launch.json，能够支持单文件和多文件的编译和调试

**步骤：**

1. 创建一个空文件夹，然后选择用vscode打开

2. 在文件夹里编写一个c++文件 （也可以在里面再次创建一个存放c++源码的文件夹）

3. 然后选择g++编译运行该文件，此时会自动生成tasks.json文件

    <img src="./../99.Figure/03-013/image-20230823112220225.png" alt="image-20230823112220225" />

4. tasks.json文件在.vscode文件夹下，按需求可以自行修改

    ```json
    {
        "tasks": [
            {
                "type": "cppbuild",
                "label": "C/C++: g++.exe build active file",
                "command": "D:\\mingw\\bin\\g++.exe", // 编译器的路径
                "args": [    // 编译参数
                    "-fdiagnostics-color=always",
                    "-g",
                    // "${file}",  //需要编译的当前文件名，只能编译单文件
    ---->           "${fileDirname}\\*.c*", //将文件夹下的所有.c*文件都编译，用于多文件编译
                    "-o",  //对象名，不进行编译优化
                    "${fileDirname}\\${fileBasenameNoExtension}.exe", //生成的可执行文件存放路径及名字
                    // "-std=c++17",  //使用c++17标准编译
                    // "-std=c++2a",  //使用c++20标准编译
                    // "-fexec-charset=GBK" //如果出现乱码的情况，可以加上这一句
                ],
                "options": {
                    "cwd": "${fileDirname}" //当前工作目录
                },
                "problemMatcher": [
                    "$gcc"
                ],
                "group": {
                    "kind": "build",
                    "isDefault": true
                },
                "detail": "Task generated by Debugger."
            }
        ],
        "version": "2.0.0"
    }
    ```

5. 创建launch.json文件用于调试

    <img src="./../99.Figure/03-013/image-20230823113158134.png" alt="image-20230823113158134" />

    <img src="./../99.Figure/03-013/image-20230823113335574.png" alt="image-20230823113335574" style="zoom: 80%;" />

6. launch.json文件在.vscode文件夹下，==有几处需要自行修改==

    ```json
    {
        // Use IntelliSense to learn about possible attributes.
        // Hover to view descriptions of existing attributes.
        // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
        "version": "0.2.0",
        "configurations": [
            {
                "name": "(gdb) Launch",
                "type": "cppdbg",
                "request": "launch",
                "program": "${fileDirname}\\${fileBasenameNoExtension}.exe", //这一处需要修改，修改成需要调试的文件的路径
                "args": [],
                "stopAtEntry": false,
                "cwd": "${fileDirname}",
                "environment": [],
                "externalConsole": false,
                "MIMode": "gdb",
                "miDebuggerPath": "D:\\mingw\\bin\\gdb.exe", //这一处需要修改，就修改成这个路径
                "setupCommands": [
                    {
                        "description": "Enable pretty-printing for gdb",
                        "text": "-enable-pretty-printing",
                        "ignoreFailures": true
                    },
                    {
                        "description": "Set Disassembly Flavor to Intel",
                        "text": "-gdb-set disassembly-flavor intel",
                        "ignoreFailures": true
                    }
                ]
            }
        ]
    }
    ```

7. 根据以上配置，基本就可以实现一个c++项目的创建了。



**补充：** 如果我们使用Code Runner来运行多文件，需要对它的编译命令进行修改

<img src="./../99.Figure/03-013/image-20230823114022101.png" alt="image-20230823114022101" style="zoom:80%;" />

```json
// "c": "cd $dir && gcc $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt", //单文件
"c": "cd $dir && gcc *.c* -o $fileNameWithoutExt && $dir$fileNameWithoutExt", //多文件
// "cpp": "cd $dir && g++ $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
"cpp": "cd $dir && g++ *.c* -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
// "cpp": "cd $dir && g++ -std=c++2a *.c* -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
// 使用c++20标准编译，暂不支持23

// 如果出现乱码情况，可以添加如下配置
"c": "cd $dir && gcc *.c* -o $fileNameWithoutExt -fexec-charset=GBK && $dir$fileNameWithoutExt",
"cpp": "cd $dir && g++ *.c* -o $fileNameWithoutExt -fexec-charset=GBK && $dir$fileNameWithoutExt",
```





## 补充

如何下载最新版本的MinGW

**网址：**[Downloads - MinGW-w64](https://www.mingw-w64.org/downloads/)

![image-20231006190529959](./../99.Figure/03-013/image-20231006190529959.png)

![image-20231006190609198](./../99.Figure/03-013/image-20231006190609198.png)
